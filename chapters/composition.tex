Having presented the QPU characteristics, the principle of composing QPUs in a DAG, and the graph's computation model,
the goal of this chapter is to concretely.

\section{QPU query processing capabilities}

Each QPU is responsible/capable of processing queries in a specific space. These capabilities depend on:
\begin{itemize}
  \item The QPU's functionality (class).
  \item It's configuration.
  \item It's child connections in the graph.
\end{itemize}

QPUs maintain metadata (state) that describe their own capabilities, as well as their knowledge of the capabilities of
their child connections.

In this section we describe the format of the query processing capabilities state. We defer the description of how QPUs
populate this state for the following section.

\section{Distributed query processing protocol}
In this section we present the protocol that QPUs use to retrieve intermediate query responses for a given query by
sending sub-queries to child QPUs.

In detail, we present the algorithms for:
\begin{itemize}
  \item Determining given query a QPU can process locally and which it needs to forward to child connections.
  \item How a QPU uses its knowledge of the query processing capabilities of its child connections to generate and send
  sub-queries.
\end{itemize}

This protocol runs locally at each QPU and requires no central coordination.

\section{Configuration Dissemination}
In this section we describe how QPUs build/populate the query processing capabilities state.

Overview:
\begin{itemize}
  \item In the case of the index QPU, its configuration explicitly describes which queries can be processed locally
  (using the index).
  \item For other QPUs (e.g. filter, cache), their capabilities depend on the capabilities of their child connections.
  For example, if a cache QPU is connected to an index QPU, it inherits the query capabilities of that QPU.
\end{itemize}

Here, we also define the operation of combining the capabilities of more than one QPUs (a QPU uses that operation to
calculate its capabilities given its configuration and the capabilities of its children)

\subsection{Configuration propagation API}


